<!doctype html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <link rel="stylesheet" href="https://webslides.tv/static/css/webslides.css">
  <link rel="stylesheet" href="https://webslides.tv/static/css/svg-icons.css">
  <title>alexhatchl — portfolio</title>
</head>
<body>
<main role="main">
  <article id="webslides">
    <section class="fullscreen aligncenter" id="pixel-rain-intro">
  <style>
    #pixel-rain-intro { background:#fff; }
    #pixel-rain-intro .stage {
      position:absolute; inset:0; width:100%; height:100%;
      image-rendering: pixelated; image-rendering: crisp-edges; display:block;
    }
    #pixel-rain-intro .overlay {
      position:relative; z-index:3; height:100%;
      display:grid; place-items:center; color:#000;
    }
    #pixel-rain-intro h1 { margin:0; font-size:4rem; letter-spacing:.06em; }
    #pixel-rain-intro .loading {
      position:absolute; bottom:24px; left:24px; color:#666;
      font-size:.9rem; z-index:4;
    }
    @media (max-width:720px) {
      #pixel-rain-intro h1 { font-size:2.6rem; }
    }
  </style>

  <canvas class="stage" id="px-bg"></canvas>
  <canvas class="stage" id="px-rain" style="z-index:2;"></canvas>
  <div class="overlay"><h1>alexhatchl</h1></div>
  <div class="loading" id="px-load">lädt…</div>

  <script>
  (function(){
    const section = document.getElementById('pixel-rain-intro');
    const bg = document.getElementById('px-bg'), rg = document.getElementById('px-rain');
    const bgx = bg.getContext('2d', {alpha:false}), rgx = rg.getContext('2d', {alpha:true});
    bgx.imageSmoothingEnabled = false; rgx.imageSmoothingEnabled = false;

    const PIX_WIDTH = 320, CONTRAST = 0.95;
    const PALETTE = [0,85,170,255];
    const SOURCE = 'images/window-city.jpg';

    function clamp(v, mi, ma) { return v<mi?mi:v>ma?ma:v; }
    function contrast(v, c) { return clamp((v-128)*c+128, 0, 255); }
    function nearest4(g) {
      return PALETTE.reduce((best,p)=>(Math.abs(p-g)<Math.abs(best-g)?p:best), PALETTE[0]);
    }

    function fitCanvas(){
      const r = section.getBoundingClientRect();
      bg.width = rg.width = Math.max(2, Math.floor(r.width));
      bg.height= rg.height= Math.max(2, Math.floor(r.height));
      bgx.fillStyle = '#fff'; bgx.fillRect(0,0,bg.width,bg.height);
    }
    new ResizeObserver(fitCanvas).observe(section);
    fitCanvas();

    const img = new Image();
    img.onload = ()=>{ renderBackground(); pxload.style.display='none'; };
    img.onerror = ()=>{ pxload.textContent = 'Bild nicht gefunden: ' + SOURCE; };
    img.src = SOURCE;
    const pxload = document.getElementById('px-load');

    function renderBackground(){
      const r = img.height / img.width;
      const w = PIX_WIDTH, h = Math.round(w * r);
      const small = document.createElement('canvas');
      small.width = w; small.height = h;
      const sx = small.getContext('2d');
      sx.imageSmoothingEnabled = false;
      sx.drawImage(img, 0, 0, w, h);

      const id = sx.getImageData(0,0,w,h), d = id.data;
      for (let i=0; i<d.length; i+=4) {
        let g = 0.299*d[i] + 0.587*d[i+1] + 0.114*d[i+2];
        g = contrast(g, CONTRAST);
        const q = nearest4(g);
        d[i]=d[i+1]=d[i+2]=q; d[i+3]=255;
      }
      sx.putImageData(id, 0, 0);
      drawCover(bgx, small);
    }

    function drawCover(ctx, src){
      const W = ctx.canvas.width, H = ctx.canvas.height;
      const sw = src.width, sh = src.height, sR = sw/sh, tR = W/H;
      let dw = W, dh = Math.round(W/sR);
      if (dh < H) { dh=H; dw=Math.round(H*sR); }
      const dx = Math.round((W-dw)/2), dy = Math.round((H-dh)/2);
      ctx.imageSmoothingEnabled = false;
      ctx.fillStyle = '#fff'; ctx.fillRect(0,0,W,H);
      ctx.drawImage(src,0,0,sw,sh,dx,dy,dw,dh);
    }

    const COLS = 64;
    const streaks = Array.from({length:COLS},(_,i)=>({
      xNorm:(i+Math.random()*0.5)/COLS, y:Math.random(), v:0.08+Math.random()*0.22,
      len:0.05+Math.random()*0.18, wob:Math.random()*0.5+0.15
    }));

    function rainFrame(t){
      const W = rg.width, H = rg.height;
      rgx.clearRect(0,0,W,H);
      rgx.globalAlpha=0.06; rgx.fillStyle='#000'; rgx.fillRect(0,0,W,H); rgx.globalAlpha=1;
      rgx.fillStyle='#000';
      streaks.forEach(s=>{
        const x = Math.round(s.xNorm*W + Math.sin(t*0.0009 + s.xNorm*10)*s.wob*6);
        const y = s.y*H, L = Math.round(s.len*H);
        for (let k=0; k<L; k+=2) {
          const yy = Math.round(y + k);
          if (yy>=0 && yy<H) {
            rgx.fillRect(x, yy, 1, 1);
            if (k % 6===0) {
              if (x+1 < W) rgx.fillRect(x+1,yy,1,1);
              if (x-1 >=0) rgx.fillRect(x-1,yy,1,1);
            }
          }
        }
        rgx.fillRect(x-1, Math.round(y+L+1),3,2);
        s.y += s.v*0.016;
        if (s.y*H > H+12) {
          s.y = -Math.random()*0.2;
          s.len = 0.05 + Math.random()*0.18;
          s.v = 0.08 + Math.random()*0.22;
        }
      });
      requestAnimationFrame(rainFrame);
    }
    requestAnimationFrame(rainFrame);

    document.addEventListener('ws:slide-change', ()=>{ fitCanvas(); if (img.complete) renderBackground(); });
    window.addEventListener('resize', ()=>{ fitCanvas(); if (img.complete) renderBackground(); }, {passive:true});
  })();
  </script>
</section>


  </article>
</main>
<script src="https://webslides.tv/static/js/webslides.js"></script>
<script>window.ws=new WebSlides();</script>
<script defer src="https://webslides.tv/static/js/svg-icons.js"></script>
</body>
</html>
